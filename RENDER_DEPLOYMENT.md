# ERT Render Deployment Guide

## üöÄ Quick Deployment Steps

### 1. **Prepare Repository**
Your ERT repository is already configured for Render deployment with:
- ‚úÖ `render.yaml` - Deployment configuration
- ‚úÖ `wsgi.py` - WSGI entry point
- ‚úÖ `requirements.txt` - Updated with gunicorn
- ‚úÖ Production-ready configuration system

### 2. **Deploy to Render**

1. **Connect Repository**:
   - Go to [Render Dashboard](https://dashboard.render.com)
   - Click "New +" ‚Üí "Web Service"
   - Connect your GitHub repository

2. **Deployment Settings**:
   - **Build Command**: `pip install --upgrade pip && pip install --no-cache-dir -r requirements.txt`
   - **Start Command**: `gunicorn --worker-class eventlet -w 1 --bind 0.0.0.0:$PORT wsgi:app`
   - **Health Check Path**: `/health`

3. **Environment Variables**:
   ```bash
   PYTHON_VERSION=3.10.12
   FLASK_ENV=production
   PYTHONPATH=/opt/render/project/src
   ADVANCED_FEATURES=true
   OLLAMA_INTEGRATION=false
   OPENAI_INTEGRATION=false
   CACHE_TTL_SECONDS=300
   MAX_TICKER_LENGTH=12
   MAX_QUEUE_SIZE=100
   ERT_HOST=0.0.0.0
   ERT_DEBUG=false
   ERT_SECRET_KEY=<auto-generated>
   ```

### 3. **Alternative: Blueprint Deployment**
Use the provided `render.yaml` file for automatic deployment:

1. Fork/clone this repository
2. Push to your GitHub
3. In Render, create "New Blueprint"
4. Connect repository and deploy

---

## üîß **Configuration Details**

### **Service Configuration** (`render.yaml`)
```yaml
services:
  - type: web
    name: ert-dashboard
    env: python
    plan: starter
    buildCommand: pip install --upgrade pip && pip install --no-cache-dir -r requirements.txt
    startCommand: gunicorn --worker-class eventlet -w 1 --bind 0.0.0.0:$PORT wsgi:app
    healthCheckPath: /health
```

### **Production Features**
- **WSGI Server**: Gunicorn with eventlet workers for WebSocket support
- **Health Checks**: `/health` endpoint for monitoring
- **Security**: Production secret key generation
- **Logging**: Structured JSON logs
- **Caching**: 5-minute TTL cache for financial data
- **Error Handling**: Graceful degradation when external services unavailable

### **Resource Requirements**
- **Plan**: Starter (512MB RAM, 0.5 CPU)
- **Scale**: Single worker recommended for WebSocket consistency
- **Storage**: Ephemeral (reports stored temporarily)

---

## üìä **Post-Deployment Verification**

### **Health Check**
```bash
curl https://your-app.onrender.com/health
```
Expected response:
```json
{
    "status": "healthy",
    "timestamp": "2024-XX-XXTXX:XX:XX.XXXXXX",
    "version": "1.0.0",
    "active_reports": 0,
    "queue_size": 0
}
```

### **Dashboard Access**
- Main Dashboard: `https://your-app.onrender.com/`
- API Status: `https://your-app.onrender.com/api/status`
- Report Generation: `https://your-app.onrender.com/api/generate`

### **Test Report Generation**
1. Open dashboard in browser
2. Enter a valid ticker symbol (e.g., "AAPL")
3. Click "Generate Report"
4. Monitor progress in real-time

---

## üõ°Ô∏è **Security Considerations**

### **Environment Variables**
- ‚úÖ `ERT_SECRET_KEY` - Auto-generated by Render
- ‚úÖ `FLASK_ENV=production` - Disables debug mode
- ‚úÖ `ERT_DEBUG=false` - Additional debug protection

### **Feature Configuration**
- ‚úÖ `OLLAMA_INTEGRATION=false` - Disabled for cloud deployment
- ‚úÖ `OPENAI_INTEGRATION=false` - No API keys in environment
- ‚úÖ Mock mode fallback for AI features

### **Data Security**
- ‚úÖ No persistent storage of sensitive data
- ‚úÖ Reports stored temporarily in memory/ephemeral storage
- ‚úÖ Financial data fetched from public APIs only

---

## üîÑ **Monitoring & Maintenance**

### **Render Dashboard**
- Monitor service health and logs
- View deployment history
- Configure custom domains
- Set up notifications

### **Application Monitoring**
- Health check endpoint: `/health`
- System status: `/api/status`
- Performance metrics in logs
- Error tracking with context

### **Log Analysis**
Render provides:
- Real-time log streaming
- Historical log access
- Search and filtering
- Export capabilities

---

## üìà **Scaling Options**

### **Vertical Scaling**
- Upgrade to Standard/Pro plans for more resources
- Increase memory for larger financial datasets
- Add CPU for faster report generation

### **Horizontal Scaling**
- Multiple service instances (requires external session storage)
- Load balancer configuration
- Database backend for persistent reports

### **Database Integration**
For persistent storage, consider:
- PostgreSQL addon for report history
- Redis addon for session management
- External S3 for report file storage

---

## üö® **Troubleshooting**

### **Common Issues**

1. **Build Failures**
   - Check Python version compatibility
   - Verify requirements.txt syntax
   - Review build logs for dependency conflicts

2. **Health Check Failures**
   - Ensure `/health` endpoint responds
   - Check for application startup errors
   - Verify port binding (uses $PORT from Render)

3. **WebSocket Issues**
   - Confirm eventlet worker class
   - Check CORS configuration
   - Verify SocketIO initialization

### **Debug Steps**
1. Check Render logs for startup errors
2. Test health endpoint manually
3. Verify environment variables
4. Review application configuration

---

## üéØ **Success Criteria**

Your ERT deployment is successful when:
- ‚úÖ Health check returns 200 status
- ‚úÖ Dashboard loads without errors
- ‚úÖ Real-time updates work via WebSocket
- ‚úÖ Report generation starts (mock mode)
- ‚úÖ API endpoints respond correctly

The system is now ready for production use with full financial analysis capabilities!